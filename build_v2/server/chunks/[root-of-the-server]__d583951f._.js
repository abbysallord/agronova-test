module.exports=[93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},91036,e=>{"use strict";var t=e.i(60583),r=e.i(17921),a=e.i(6468),i=e.i(68304),n=e.i(60485),o=e.i(17584),s=e.i(51833),l=e.i(98098),p=e.i(21469),d=e.i(71215),u=e.i(7535),c=e.i(11066),f=e.i(51606),h=e.i(21765),m=e.i(7301),g=e.i(65199),x=e.i(93695);e.i(14914);var v=e.i(72312),R=e.i(45023),y=e.i(3325);async function w(e){try{let t=await e.formData(),r=t.get("type");if(!process.env.MISTRAL_API_KEY)return y.NextResponse.json({error:"MISTRAL_API_KEY not configured"},{status:500});let a=new R.Mistral({apiKey:process.env.MISTRAL_API_KEY}),i="",n=[];if("manual"===r){let e=t.get("n"),r=t.get("p"),a=t.get("k"),o=t.get("ph"),s=t.get("moisture"),l=t.get("location"),p=t.get("color");i=`Analyze the following soil data for a farmer in ${l||"India"}:
        - Nitrogen (N): ${e}
        - Phosphorus (P): ${r}
        - Potassium (K): ${a}
        - pH Level: ${o}
        - Moisture: ${s}%
        - Color: ${p}

        Return a specific, helpful report for the farmer in JSON format:
        {
            "soil_type": "Scientific name (e.g., Silty Loam)",
            "description": "Simple explanation of what this soil means for their farm.",
            "suitable_crops": ["List", "of", "5", "best", "crops"],
            "needs_water": "High | Medium | Low",
            "irrigation_advice": "Specific advice on how/when to water.",
            "fertilizer_recommendation": "Specific organic and chemical fertilizers to balance the nutrients.",
            "improvement_tips": "2-3 actionable tips to improve soil quality."
        }
        Keep language simple, encouraging, and farmer-friendly.`,n=[{role:"user",content:i}]}else{if("image"!==r)return y.NextResponse.json({error:"Invalid analysis type"},{status:400});let e=t.get("image");if(!e)return y.NextResponse.json({error:"No image provided"},{status:400});let a=await e.arrayBuffer(),o=Buffer.from(a).toString("base64"),s=`data:${e.type};base64,${o}`;i=`Analyze this soil image. First, strictly verify if this is an image of soil, dirt, or farmland.
        If the image is NOT soil (e.g., fruit, vegetable, animal, person, object), return ONLY this JSON: {"error": "Not a soil image. Please upload a clear photo of soil or farmland."}
        
        If it IS soil, identify the soil type and return a helpful report for a farmer in JSON format:
        {
            "soil_type": "Visual identification (e.g. Red Clay, Black Cotton Soil)",
            "description": "Explanation of the soil's visible properties.",
            "suitable_crops": ["List", "of", "5", "best", "crops"],
            "needs_water": "High | Medium | Low",
            "irrigation_advice": "Advice based on likely water retention.",
            "fertilizer_recommendation": "General fertilizer advice for this soil type.",
            "improvement_tips": "Tips to manage this specific soil structure."
        }
        Keep language simple.`,n=[{role:"user",content:[{type:"text",text:i},{type:"image_url",imageUrl:s}]}]}let o=await a.chat.complete({model:"pixtral-12b-2409",messages:n,responseFormat:{type:"json_object"}}),s=o.choices?.[0]?.message?.content;if(!s)throw Error("No content from AI");let l=s.replace(/```json/g,"").replace(/```/g,"").trim(),p=JSON.parse(l);return y.NextResponse.json(p)}catch(e){return console.error("Soil Analysis Error:",e),y.NextResponse.json({error:e.message},{status:500})}}e.s(["POST",()=>w],35226);var E=e.i(35226);let b=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/analyze-soil/route",pathname:"/api/analyze-soil",filename:"route",bundlePath:""},distDir:"build_v2",relativeProjectDir:"",resolvedPagePath:"[project]/agronova/app/api/analyze-soil/route.ts",nextConfigOutput:"",userland:E}),{workAsyncStorage:_,workUnitAsyncStorage:A,serverHooks:N}=b;function C(){return(0,a.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:A})}async function S(e,t,a){b.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/analyze-soil/route";R=R.replace(/\/index$/,"")||"/";let y=await b.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!y)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:w,params:E,nextConfig:_,parsedUrl:A,isDraftMode:N,prerenderManifest:C,routerServerContext:S,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,resolvedPathname:O,clientReferenceManifest:I,serverActionsManifest:j}=y,k=(0,l.normalizeAppPath)(R),M=!!(C.dynamicRoutes[k]||C.routes[O]),q=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,A,!1):t.end("This page could not be found"),null);if(M&&!N){let e=!!C.routes[O],t=C.dynamicRoutes[k];if(t&&!1===t.fallback&&!e){if(_.experimental.adapterPath)return await q();throw new x.NoFallbackError}}let H=null;!M||b.isDev||N||(H="/index"===(H=O)?"/":H);let $=!0===b.isDev||!M,U=M&&!$;j&&I&&(0,o.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:I,serverActionsManifest:j,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:j})});let K=e.method||"GET",L=(0,n.getTracer)(),D=L.getActiveScopeSpan(),z={params:E,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!_.experimental.authInterrupts},cacheComponents:!!_.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:_.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>b.onRequestError(e,t,a,S)},sharedContext:{buildId:w}},F=new p.NodeNextRequest(e),B=new p.NodeNextResponse(t),G=d.NextRequestAdapter.fromNodeNextRequest(F,(0,d.signalFromNodeResponse)(t));try{let o=async e=>b.handle(G,z).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${K} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${K} ${R}`)}),s=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var n,l;let p=async({previousCacheEntry:r})=>{try{if(!s&&P&&T&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(i);e.fetchMetrics=z.renderOpts.fetchMetrics;let l=z.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let p=z.renderOpts.collectedTags;if(!M)return await (0,f.sendResponse)(F,B,n,z.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);p&&(t[g.NEXT_CACHE_TAGS_HEADER]=p),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==z.renderOpts.collectedRevalidate&&!(z.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&z.renderOpts.collectedRevalidate,a=void 0===z.renderOpts.collectedExpire||z.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:z.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await b.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:P})},S),t}},d=await b.handleResponse({req:e,nextConfig:_,cacheKey:H,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:T,responseGenerator:p,waitUntil:a.waitUntil,isMinimalMode:s});if(!M)return null;if((null==d||null==(n=d.value)?void 0:n.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",P?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),N&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return s&&M||u.delete(g.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,m.getCacheControlHeader)(d.cacheControl)),await (0,f.sendResponse)(F,B,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};D?await l(D):await L.withPropagatedContext(e.headers,()=>L.trace(u.BaseServerSpan.handleRequest,{spanName:`${K} ${R}`,kind:n.SpanKind.SERVER,attributes:{"http.method":K,"http.target":e.url}},l))}catch(t){if(t instanceof x.NoFallbackError||await b.onRequestError(e,t,{routerKind:"App Router",routePath:k,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:P})}),M)throw t;return await (0,f.sendResponse)(F,B,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>C,"routeModule",()=>b,"serverHooks",()=>N,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>A],91036)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d583951f._.js.map